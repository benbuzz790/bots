"""
Double Helix - Two-Voice Perpetual Motion

This piece features TWO independent melodic lines, both moving in continuous
sixteenth notes (0.25 beats), creating a flowing counterpoint where both
voices are equally active and melodic.

TREBLE VOICE: Continuous sixteenth notes
- Upper register melody
- Flowing, independent line

BASS VOICE: Also continuous sixteenth notes!
- Lower register melody
- Moves independently from treble
- Creates counterpoint and harmony

The two voices interweave like a double helix, sometimes moving in parallel,
sometimes in contrary motion, sometimes crossing, but always both active.
This is true two-part invention style.

Tempo: 112 BPM (Moderate - clear but flowing)
Duration: ~60 seconds
Key: C Major (clear and bright)
Style: Two-part invention / Counterpoint study
"""

import os
import sys

# Add parent directories to path to import beep module directly
sys.path.insert(0, os.path.join(os.path.dirname(__file__), "..", ".."))

from tools.beep import piano


def play_double_helix():
    """Play the Double Helix composition."""

    song = " ".join(
        [
            # OPENING: Voices enter separately then combine (8 beats)
            # Treble alone (2 beats)
            "C5:0.25 D5:0.25 E5:0.25 F5:0.25",
            "G5:0.25 A5:0.25 B5:0.25 C6:0.25",
            # Bass enters (2 beats) - treble continues
            "[C5:0.25,C3:0.25]:0.25 [D5:0.25,D3:0.25]:0.25 [E5:0.25,E3:0.25]:0.25 [F5:0.25,F3:0.25]:0.25",
            "[G5:0.25,G3:0.25]:0.25 [A5:0.25,A3:0.25]:0.25 [B5:0.25,B3:0.25]:0.25 [C6:0.25,C4:0.25]:0.25",
            # Both voices active (4 beats)
            "[D6:0.25,B3:0.25]:0.25 [C6:0.25,A3:0.25]:0.25 [B5:0.25,G3:0.25]:0.25 [A5:0.25,F3:0.25]:0.25",
            "[G5:0.25,E3:0.25]:0.25 [F5:0.25,D3:0.25]:0.25 [E5:0.25,C3:0.25]:0.25 [D5:0.25,B2:0.25]:0.25",
            "[C5:0.25,C3:0.25]:0.25 [B4:0.25,D3:0.25]:0.25 [A4:0.25,E3:0.25]:0.25 [G4:0.25,F3:0.25]:0.25",
            "[F4:0.25,G3:0.25]:0.25 [E4:0.25,A3:0.25]:0.25 [D4:0.25,B3:0.25]:0.25 [C4:0.25,C4:0.25]:0.25",
            # SECTION 1: Parallel motion (8 beats)
            "[E4:0.25,E3:0.25]:0.25 [F4:0.25,F3:0.25]:0.25 [G4:0.25,G3:0.25]:0.25 [A4:0.25,A3:0.25]:0.25",
            "[B4:0.25,B3:0.25]:0.25 [C5:0.25,C4:0.25]:0.25 [D5:0.25,D4:0.25]:0.25 [E5:0.25,E4:0.25]:0.25",
            "[F5:0.25,F4:0.25]:0.25 [E5:0.25,E4:0.25]:0.25 [D5:0.25,D4:0.25]:0.25 [C5:0.25,C4:0.25]:0.25",
            "[B4:0.25,B3:0.25]:0.25 [A4:0.25,A3:0.25]:0.25 [G4:0.25,G3:0.25]:0.25 [F4:0.25,F3:0.25]:0.25",
            "[E4:0.25,E3:0.25]:0.25 [G4:0.25,G3:0.25]:0.25 [C5:0.25,C4:0.25]:0.25 [E5:0.25,E4:0.25]:0.25",
            "[G5:0.25,G4:0.25]:0.25 [E5:0.25,E4:0.25]:0.25 [C5:0.25,C4:0.25]:0.25 [G4:0.25,G3:0.25]:0.25",
            "[E4:0.25,E3:0.25]:0.25 [C4:0.25,C3:0.25]:0.25 [G3:0.25,G2:0.25]:0.25 [E3:0.25,E2:0.25]:0.25",
            "[C3:0.25,C2:0.25]:0.25 [E3:0.25,E2:0.25]:0.25 [G3:0.25,G2:0.25]:0.25 [C4:0.25,C3:0.25]:0.25",
            # SECTION 2: Contrary motion (8 beats)
            "[C5:0.25,C3:0.25]:0.25 [D5:0.25,B2:0.25]:0.25 [E5:0.25,A2:0.25]:0.25 [F5:0.25,G2:0.25]:0.25",
            "[G5:0.25,F2:0.25]:0.25 [A5:0.25,E2:0.25]:0.25 [B5:0.25,D2:0.25]:0.25 [C6:0.25,C2:0.25]:0.25",
            "[B5:0.25,D2:0.25]:0.25 [A5:0.25,E2:0.25]:0.25 [G5:0.25,F2:0.25]:0.25 [F5:0.25,G2:0.25]:0.25",
            "[E5:0.25,A2:0.25]:0.25 [D5:0.25,B2:0.25]:0.25 [C5:0.25,C3:0.25]:0.25 [B4:0.25,D3:0.25]:0.25",
            "[A4:0.25,E3:0.25]:0.25 [B4:0.25,D3:0.25]:0.25 [C5:0.25,C3:0.25]:0.25 [D5:0.25,B2:0.25]:0.25",
            "[E5:0.25,A2:0.25]:0.25 [D5:0.25,B2:0.25]:0.25 [C5:0.25,C3:0.25]:0.25 [B4:0.25,D3:0.25]:0.25",
            "[A4:0.25,E3:0.25]:0.25 [G4:0.25,F3:0.25]:0.25 [F4:0.25,G3:0.25]:0.25 [E4:0.25,A3:0.25]:0.25",
            "[D4:0.25,B3:0.25]:0.25 [C4:0.25,C4:0.25]:0.25 [B3:0.25,D4:0.25]:0.25 [A3:0.25,E4:0.25]:0.25",
            # SECTION 3: Interweaving (8 beats)
            "[C5:0.25,E3:0.25]:0.25 [E4:0.25,G3:0.25]:0.25 [G4:0.25,C4:0.25]:0.25 [C5:0.25,E4:0.25]:0.25",
            "[E5:0.25,G4:0.25]:0.25 [G5:0.25,C5:0.25]:0.25 [C6:0.25,E5:0.25]:0.25 [G5:0.25,G5:0.25]:0.25",
            "[E5:0.25,C5:0.25]:0.25 [C5:0.25,E4:0.25]:0.25 [G4:0.25,C4:0.25]:0.25 [E4:0.25,G3:0.25]:0.25",
            "[C4:0.25,E3:0.25]:0.25 [G3:0.25,C3:0.25]:0.25 [E3:0.25,G2:0.25]:0.25 [C3:0.25,C2:0.25]:0.25",
            "[D5:0.25,F3:0.25]:0.25 [F4:0.25,A3:0.25]:0.25 [A4:0.25,D4:0.25]:0.25 [D5:0.25,F4:0.25]:0.25",
            "[F5:0.25,A4:0.25]:0.25 [A5:0.25,D5:0.25]:0.25 [D6:0.25,F5:0.25]:0.25 [A5:0.25,A5:0.25]:0.25",
            "[F5:0.25,D5:0.25]:0.25 [D5:0.25,F4:0.25]:0.25 [A4:0.25,D4:0.25]:0.25 [F4:0.25,A3:0.25]:0.25",
            "[D4:0.25,F3:0.25]:0.25 [A3:0.25,D3:0.25]:0.25 [F3:0.25,A2:0.25]:0.25 [D3:0.25,D2:0.25]:0.25",
            # SECTION 4: Canon-like imitation (8 beats)
            "[C5:0.25,E2:0.25]:0.25 [D5:0.25,F2:0.25]:0.25 [E5:0.25,G2:0.25]:0.25 [F5:0.25,C3:0.25]:0.25",
            "[G5:0.25,D3:0.25]:0.25 [A5:0.25,E3:0.25]:0.25 [B5:0.25,F3:0.25]:0.25 [C6:0.25,G3:0.25]:0.25",
            "[D6:0.25,A3:0.25]:0.25 [C6:0.25,B3:0.25]:0.25 [B5:0.25,C4:0.25]:0.25 [A5:0.25,D4:0.25]:0.25",
            "[G5:0.25,E4:0.25]:0.25 [F5:0.25,F4:0.25]:0.25 [E5:0.25,G4:0.25]:0.25 [D5:0.25,A4:0.25]:0.25",
            "[C5:0.25,B4:0.25]:0.25 [B4:0.25,C5:0.25]:0.25 [A4:0.25,D5:0.25]:0.25 [G4:0.25,E5:0.25]:0.25",
            "[F4:0.25,F5:0.25]:0.25 [E4:0.25,G5:0.25]:0.25 [D4:0.25,A5:0.25]:0.25 [C4:0.25,B5:0.25]:0.25",
            "[B3:0.25,C6:0.25]:0.25 [A3:0.25,B5:0.25]:0.25 [G3:0.25,A5:0.25]:0.25 [F3:0.25,G5:0.25]:0.25",
            "[E3:0.25,F5:0.25]:0.25 [D3:0.25,E5:0.25]:0.25 [C3:0.25,D5:0.25]:0.25 [B2:0.25,C5:0.25]:0.25",
            # SECTION 5: Convergence (8 beats)
            "[C5:0.25,C3:0.25]:0.25 [E5:0.25,E3:0.25]:0.25 [G5:0.25,G3:0.25]:0.25 [C6:0.25,C4:0.25]:0.25",
            "[E6:0.25,E4:0.25]:0.25 [C6:0.25,C4:0.25]:0.25 [G5:0.25,G3:0.25]:0.25 [E5:0.25,E3:0.25]:0.25",
            "[C5:0.25,C3:0.25]:0.25 [G4:0.25,G3:0.25]:0.25 [E4:0.25,E3:0.25]:0.25 [C4:0.25,C3:0.25]:0.25",
            "[G3:0.25,G3:0.25]:0.25 [E3:0.25,E3:0.25]:0.25 [C3:0.25,C3:0.25]:0.25 [G2:0.25,G2:0.25]:0.25",
            "[C3:0.25,C3:0.25]:0.25 [E3:0.25,E3:0.25]:0.25 [G3:0.25,G3:0.25]:0.25 [C4:0.25,C4:0.25]:0.25",
            "[E4:0.25,E4:0.25]:0.25 [G4:0.25,G4:0.25]:0.25 [C5:0.25,C5:0.25]:0.25 [E5:0.25,E5:0.25]:0.25",
            "[G5:0.25,G5:0.25]:0.25 [E5:0.25,E5:0.25]:0.25 [C5:0.25,C5:0.25]:0.25 [G4:0.25,G4:0.25]:0.25",
            "[E4:0.25,E4:0.25]:0.25 [C4:0.25,C4:0.25]:0.25 [G3:0.25,G3:0.25]:0.25 [E3:0.25,E3:0.25]:0.25",
            # CODA: Final unison (8 beats)
            "[C3:0.25,C3:0.25]:0.25 [D3:0.25,D3:0.25]:0.25 [E3:0.25,E3:0.25]:0.25 [F3:0.25,F3:0.25]:0.25",
            "[G3:0.25,G3:0.25]:0.25 [A3:0.25,A3:0.25]:0.25 [B3:0.25,B3:0.25]:0.25 [C4:0.25,C4:0.25]:0.25",
            "[D4:0.25,D4:0.25]:0.25 [E4:0.25,E4:0.25]:0.25 [F4:0.25,F4:0.25]:0.25 [G4:0.25,G4:0.25]:0.25",
            "[A4:0.25,A4:0.25]:0.25 [B4:0.25,B4:0.25]:0.25 [C5:0.25,C5:0.25]:0.25 [D5:0.25,D5:0.25]:0.25",
            "[E5:0.25,E5:0.25]:0.25 [F5:0.25,F5:0.25]:0.25 [G5:0.25,G5:0.25]:0.25 [A5:0.25,A5:0.25]:0.25",
            "[B5:0.25,B5:0.25]:0.25 [C6:0.25,C6:0.25]:0.25 [D6:0.25,D6:0.25]:0.25 [E6:0.25,E6:0.25]:0.25",
            "[F6:0.25,F6:0.25]:0.25 [E6:0.25,E6:0.25]:0.25 [D6:0.25,D6:0.25]:0.25 [C6:0.25,C6:0.25]:0.25",
            "[B5:0.25,B5:0.25]:0.25 [A5:0.25,A5:0.25]:0.25 [G5:0.25,G5:0.25]:0.25 [F5:0.25,F5:0.25]:0.25",
            # Final chord
            "[C2:4,C3:4,E3:4,G3:4,C4:4,E4:4,G4:4,C5:4,E5:4,G5:4,C6:4]:4",
        ]
    )

    print("ðŸ§¬ 'Double Helix' - Two-Voice Perpetual Motion ðŸ§¬\n")
    print("=" * 60)
    print("Two independent melodic lines in continuous counterpoint")
    print("=" * 60)
    print("\nðŸŽµ Playing at 112 BPM...\n")

    result = piano(song, tempo=112, voice="warm_upright")

    print(f"\n{result}")
    print("\n" + "=" * 60)
    print("âœ¨ Counterpoint Features: âœ¨")
    print("  â€¢ Two voices, both in continuous 16th notes")
    print("  â€¢ Parallel motion (voices move together)")
    print("  â€¢ Contrary motion (voices move apart)")
    print("  â€¢ Interweaving (voices cross and weave)")
    print("  â€¢ Canon-like imitation (one follows the other)")
    print("  â€¢ Convergence (voices come together)")
    print("\n  Like a Bach two-part invention! ðŸ§¬ðŸŽ¹")
    print("=" * 60)

    return result


if __name__ == "__main__":
    play_double_helix()
